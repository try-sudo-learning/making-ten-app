<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°å­¸æ•¸å­¸æ¨‚åœ’ - èªè­˜åˆåæ³•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, 'Microsoft JhengHei', sans-serif;
            background-color: #f0fdf4;
        }
        .kids-font {
            font-family: 'ZCOOL+KuaiLe', cursive;
        }
        .ten-frame-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 8px;
            background: #fff;
            padding: 10px;
            border: 4px solid #4ade80;
            border-radius: 12px;
            width: fit-content;
        }
        .cell {
            width: 50px;
            height: 50px;
            border: 2px solid #e2e8f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .dot {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes pop {
            0% { transform: scale(0); }
            100% { transform: scale(1); }
        }
        .active-dot { background-color: #ef4444; box-shadow: 0 4px 0 #b91c1c; }
        .needed-dot { background-color: #fbbf24; box-shadow: 0 4px 0 #d97706; opacity: 0.5; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .number-card {
            cursor: pointer;
            transition: transform 0.2s;
        }
        .number-card:hover { transform: translateY(-5px); }

        .step-box {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 1rem;
            padding: 1.25rem;
            transition: all 0.3s;
            position: relative;
        }
        .step-box.active {
            border-color: #3b82f6;
            background-color: #eff6ff;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }
        /* Tab Button Active State */
        .tab-btn.active {
            background-color: #dbeafe; /* bg-blue-100 */
            color: #1d4ed8; /* text-blue-700 */
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-2xl mx-auto bg-white rounded-3xl shadow-xl overflow-hidden border-4 border-green-200">
        <!-- Header -->
        <div class="bg-green-400 p-6 text-center text-white">
            <h1 class="text-3xl md:text-4xl kids-font font-bold mb-2">ğŸ­ æ•¸å­¸åˆåæ³•æ¨‚åœ’</h1>
            <p class="text-green-900 font-medium">è®“æˆ‘å€‘ä¸€èµ·è®Šé­”è¡“ï¼ŒæŠŠæ•¸å­—è®Šæˆ 10 å§ï¼</p>
        </div>

        <!-- Tabs Navigation -->
        <div id="tabs-nav" class="flex bg-green-100 border-b-2 border-green-200 overflow-x-auto">
            <button onclick="showTab('intro', this)" class="tab-btn active flex-none px-4 py-3 font-bold text-green-700 hover:bg-green-200 focus:outline-none border-r border-green-200">1. èªè­˜å¥½æœ‹å‹</button>
            <button onclick="showTab('practice', this)" class="tab-btn flex-none px-4 py-3 font-bold text-green-700 hover:bg-green-200 focus:outline-none border-r border-green-200">2. åæ ¼é™£æŒ‘æˆ°</button>
            <button onclick="showTab('advanced', this)" class="tab-btn flex-none px-4 py-3 font-bold text-green-700 hover:bg-green-200 focus:outline-none border-r border-green-200">3. æ¹Šåæ³•åŸç†</button>
            <button onclick="showTab('quiz', this)" class="tab-btn flex-none px-4 py-3 font-bold text-green-700 hover:bg-green-200 focus:outline-none">4. æ¹Šåæ³•ç·´ç¿’</button>
        </div>

        <div class="p-6">
            <!-- Tab 1: Introduction -->
            <div id="intro" class="tab-content active text-center">
                <h2 class="text-2xl font-bold text-gray-700 mb-4">èª°æ˜¯ 10 çš„å¥½æœ‹å‹ï¼Ÿ</h2>
                <p class="mb-6 text-gray-600">é»æ“Šæ•¸å­—å¡ç‰‡ï¼Œçœ‹çœ‹èª°è·Ÿå®ƒåŠ èµ·ä¾†æœƒè®Šæˆ 10ï¼</p>
                <div class="grid grid-cols-5 gap-3 mb-8" id="friends-grid"></div>
                <div id="result-display" class="h-32 flex flex-col items-center justify-center bg-yellow-50 rounded-2xl border-2 border-dashed border-yellow-300">
                    <p class="text-xl text-gray-400 italic">é»é»çœ‹ä¸Šé¢çš„æ•¸å­—...</p>
                </div>
            </div>

            <!-- Tab 2: Ten Frame Practice -->
            <div id="practice" class="tab-content text-center">
                <h2 class="text-2xl font-bold text-gray-700 mb-2">è£œé½Šåæ ¼é™£æŒ‘æˆ°</h2>
                <p class="mb-6 text-gray-600">ç´…è‰²æ˜¯ç¾æœ‰çš„ï¼Œé‚„éœ€è¦å¹¾å€‹é»ƒè‰²æ‰èƒ½è®Šæˆ 10 å‘¢ï¼Ÿ</p>
                <div class="flex justify-center mb-8">
                    <div id="ten-frame" class="ten-frame-grid"></div>
                </div>
                <div class="flex flex-col items-center gap-4">
                    <div class="text-3xl font-bold text-gray-800">
                        <span id="current-num" class="text-red-500">?</span> + 
                        <input type="number" id="user-answer" class="w-16 border-b-4 border-yellow-400 text-center focus:outline-none" placeholder="?"> = 10
                    </div>
                    <button onclick="checkAnswer()" class="bg-orange-400 hover:bg-orange-500 text-white px-8 py-2 rounded-full font-bold shadow-lg transition">æª¢æŸ¥ç­”æ¡ˆ</button>
                    <p id="feedback" class="h-6 font-bold"></p>
                    <button onclick="nextLevel()" class="text-green-600 underline font-medium">æ›ä¸‹ä¸€é¡Œ</button>
                </div>
            </div>

            <!-- Tab 3: Advanced Principles -->
            <div id="advanced" class="tab-content">
                <h2 class="text-2xl font-bold text-center text-gray-700 mb-4">å¤§çµ•æ‹›ï¼šæ¹Šåæ³•</h2>
                <div class="bg-blue-50 p-4 rounded-xl border border-blue-100 mb-6 text-center">
                    <p class="text-gray-700 font-medium">è¦æŠŠå¤§çš„æ•¸å­—è®Šæˆ 10ï¼Œè¨ˆç®—å°±ä¸æœƒå‡ºéŒ¯å›‰ï¼</p>
                </div>
                <div class="flex flex-col items-center space-y-6">
                    <div class="bg-white w-full border-2 border-green-300 rounded-2xl p-6 shadow-inner">
                        <div class="flex flex-col items-center space-y-2 text-xl md:text-2xl font-bold text-gray-800">
                            <div>8 + 5 = ?</div>
                            <div class="text-green-500">= 8 + (2 + 3) <span class="text-xs text-gray-400 font-normal ml-2">(æŠŠ 5 åˆ†æˆ 2 å’Œ 3)</span></div>
                            <div class="text-blue-500">= (8 + 2) + 3 <span class="text-xs text-gray-400 font-normal ml-2">(8 å’Œ 2 æ¹Šæˆ 10)</span></div>
                            <div class="text-red-500 bg-red-50 p-2 rounded-lg">= 10 + 3 = 13</div>
                        </div>
                    </div>
                    <p class="text-sm text-gray-500 text-center">å£è¨£ï¼šçœ‹å¤§æ•¸ï¼Œåˆ†å°æ•¸ï¼Œæ¹Šæˆåï¼ŒåŠ å‰©æ•¸ã€‚</p>
                </div>
            </div>

            <!-- Tab 4: Step-by-Step Quiz -->
            <div id="quiz" class="tab-content">
                <h2 class="text-2xl font-bold text-center text-blue-700 mb-4">é€²éšæŒ‘æˆ°ï¼šæ¹Šåæ³•ç·´ç¿’</h2>
                
                <div id="quiz-container" class="space-y-4">
                    <!-- Step 1 -->
                    <div id="q-step-1" class="step-box active">
                        <p class="font-bold text-blue-600 text-center mb-3">ç¬¬ä¸€æ­¥ï¼šåˆ†å°æ•¸</p>
                        <div class="flex flex-col items-center space-y-4">
                            <div class="text-2xl font-bold text-gray-600">é¡Œç›®ï¼š<span class="q-display-main">8 + 5</span></div>
                            <div class="flex flex-wrap items-center justify-center gap-3">
                                <span class="text-xl font-bold text-gray-700">æŠŠ <span id="q-small-num" class="text-blue-600">5</span> åˆ†æˆï¼š</span>
                                <input type="number" id="ans-split-1" class="w-16 h-12 border-2 border-blue-300 rounded-lg text-center font-bold text-2xl" placeholder="?"> 
                                <span class="text-xl font-bold text-gray-700">å’Œ</span> 
                                <input type="number" id="ans-split-2" class="w-16 h-12 border-2 border-blue-300 rounded-lg text-center font-bold text-2xl" placeholder="?">
                                <button onclick="checkStepOne()" id="btn-check-1" class="bg-blue-500 text-white px-6 py-2 rounded-xl text-lg font-bold hover:bg-blue-600 shadow-md transition">æª¢æŸ¥</button>
                            </div>
                        </div>
                        <p class="text-xs text-gray-400 text-center mt-3">(æç¤ºï¼šç‚ºäº†è®“ <span class="q-large-num-hint">8</span> è®Šæˆ 10ï¼Œç¬¬ä¸€å€‹æ•¸å­—è¦å¡«å¤šå°‘ï¼Ÿ)</p>
                    </div>

                    <!-- Step 2 -->
                    <div id="q-step-2" class="step-box opacity-30 pointer-events-none">
                        <p class="font-bold text-green-600 text-center mb-3">ç¬¬äºŒæ­¥ï¼šæ¹Šæˆå</p>
                        <div class="flex flex-col items-center space-y-4">
                            <div id="display-step2-wrapper" class="hidden text-2xl font-bold text-gray-600">è®Šèº«ï¼š<span class="q-display-step2">8 + (2 + 3)</span></div>
                            <div class="flex items-center justify-center gap-3 text-xl font-bold text-gray-700">
                                <span id="val-large-num">8</span> + <span id="val-split-1" class="text-blue-600 text-2xl">2</span> = <span class="text-red-500 text-3xl font-black">10</span>
                                <span class="ml-2 text-green-500">âœ¨ æˆåŠŸï¼</span>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3 -->
                    <div id="q-step-3" class="step-box opacity-30 pointer-events-none">
                        <p class="font-bold text-red-600 text-center mb-3">ç¬¬ä¸‰æ­¥ï¼šç®—å‡ºçµæœ</p>
                        <div class="flex flex-col items-center space-y-4">
                            <div id="display-step3-wrapper" class="hidden text-2xl font-bold text-gray-600">æœ€å¾Œï¼š<span class="q-display-step3">10 + 3</span></div>
                            <div class="flex items-center justify-center gap-3">
                                <span class="text-xl font-bold text-gray-700">10 + <span id="val-leftover" class="text-blue-600 text-2xl">3</span> = </span>
                                <input type="number" id="ans-final" class="w-24 h-12 border-2 border-red-300 rounded-lg text-center font-bold text-3xl text-red-600" placeholder="?">
                                <button onclick="checkFinalAnswer()" id="btn-check-final" class="bg-red-500 text-white px-6 py-2 rounded-xl text-lg font-bold hover:bg-red-600 shadow-md transition">é€å‡º</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer Score -->
        <div class="bg-gray-50 p-4 border-t border-gray-100 flex justify-between items-center">
            <span class="text-gray-500 text-sm italic">å­¸å¥½åˆåæ³•ï¼Œæ•¸å­¸é ‚å‘±å‘±ï¼</span>
            <div class="bg-white px-4 py-1 rounded-full border border-gray-200 text-sm font-bold">
                â­ åˆ†æ•¸ï¼š<span id="score">0</span>
            </div>
        </div>
    </div>

    <!-- Celebration Box -->
    <div id="msg-box" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden z-50 p-4">
        <div class="bg-white p-8 rounded-3xl text-center shadow-2xl max-w-sm w-full border-4 border-yellow-400">
            <p class="text-6xl mb-4">ğŸ‰</p>
            <h3 class="text-2xl font-bold text-green-600 mb-2">å¥½å²å®³ï¼</h3>
            <p id="msg-text" class="text-gray-600 mb-6 font-medium text-lg"></p>
            <button onclick="closeMsg()" class="bg-green-500 text-white px-10 py-3 rounded-full font-bold text-xl hover:bg-green-600 transition transform hover:scale-105">æŒ‘æˆ°ä¸‹ä¸€é¡Œ</button>
        </div>
    </div>

    <script>
        let score = 0;
        let currentTarget = 0;
        
        // Quiz State
        let qLarge = 0;
        let qSmall = 0;
        let qNeed = 0;
        let qStep = 1;

        window.onload = () => {
            initIntro();
            nextLevel();
            generateQuiz();
        };

        function showTab(tabId, btn) {
            // Hide all content
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            // Show selected content
            document.getElementById(tabId).classList.add('active');
            
            // Manage active state of buttons
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            if (btn) {
                btn.classList.add('active');
            }
        }

        // Tab 1: Intro
        function initIntro() {
            const grid = document.getElementById('friends-grid');
            for (let i = 1; i <= 9; i++) {
                const card = document.createElement('div');
                card.className = "number-card bg-white border-2 border-green-300 rounded-xl p-4 text-2xl font-bold text-green-600 shadow-sm text-center hover:bg-green-50";
                card.innerText = i;
                card.onclick = () => showFriend(i);
                grid.appendChild(card);
            }
        }

        function showFriend(n) {
            const friend = 10 - n;
            const display = document.getElementById('result-display');
            display.innerHTML = `
                <div class="flex items-center gap-4 animate-bounce">
                    <span class="text-4xl font-bold text-red-500">${n}</span>
                    <span class="text-2xl text-gray-400">+</span>
                    <span class="text-4xl font-bold text-blue-500">${friend}</span>
                    <span class="text-2xl text-gray-400">=</span>
                    <span class="text-4xl font-bold text-green-600">10</span>
                </div>
                <p class="mt-2 text-gray-500 font-bold">${n} çš„å¥½æœ‹å‹æ˜¯ ${friend}ï¼</p>
            `;
        }

        // Tab 2: Practice
        function nextLevel() {
            currentTarget = Math.floor(Math.random() * 9) + 1;
            document.getElementById('current-num').innerText = currentTarget;
            document.getElementById('user-answer').value = '';
            document.getElementById('feedback').innerText = '';
            renderTenFrame(currentTarget);
        }

        function renderTenFrame(num) {
            const frame = document.getElementById('ten-frame');
            frame.innerHTML = '';
            for (let i = 0; i < 10; i++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                if (i < num) {
                    const dot = document.createElement('div');
                    dot.className = 'dot active-dot';
                    cell.appendChild(dot);
                }
                frame.appendChild(cell);
            }
        }

        function checkAnswer() {
            const val = parseInt(document.getElementById('user-answer').value);
            if (val === (10 - currentTarget)) {
                score += 10;
                document.getElementById('score').innerText = score;
                showCelebration(`${currentTarget} + ${val} = 10`);
            } else {
                document.getElementById('feedback').innerText = "âŒ æ•¸æ•¸çœ‹é‚„æœ‰å¹¾å€‹æ ¼å­æ²’åœ“é»ï¼Ÿ";
                document.getElementById('feedback').className = "text-red-500 font-bold";
            }
        }

        // Tab 4: Quiz Logic
        function generateQuiz() {
            qStep = 1;
            qLarge = Math.floor(Math.random() * 4) + 6; // 6-9
            qSmall = Math.floor(Math.random() * 5) + 4; // 4-8
            qNeed = 10 - qLarge;

            // Update UI Displays
            const formula = `${qLarge} + ${qSmall}`;
            document.querySelectorAll('.q-display-main').forEach(el => el.innerText = formula);
            document.querySelectorAll('.q-large-num-hint').forEach(el => el.innerText = qLarge);
            document.getElementById('q-small-num').innerText = qSmall;
            document.getElementById('val-large-num').innerText = qLarge;
            
            resetQuizUI();
        }

        function resetQuizUI() {
            document.getElementById('ans-split-1').value = '';
            document.getElementById('ans-split-2').value = '';
            document.getElementById('ans-final').value = '';
            document.getElementById('ans-split-1').disabled = false;
            document.getElementById('ans-split-2').disabled = false;
            document.getElementById('ans-final').disabled = true;

            document.getElementById('q-step-1').className = "step-box active";
            document.getElementById('q-step-2').className = "step-box opacity-30 pointer-events-none";
            document.getElementById('q-step-3').className = "step-box opacity-30 pointer-events-none";
            
            document.getElementById('display-step2-wrapper').classList.add('hidden');
            document.getElementById('display-step3-wrapper').classList.add('hidden');

            document.getElementById('val-split-1').innerText = "?";
            document.getElementById('val-leftover').innerText = "?";
        }

        function checkStepOne() {
            const s1 = parseInt(document.getElementById('ans-split-1').value);
            const s2 = parseInt(document.getElementById('ans-split-2').value);
            
            if (isNaN(s1) || isNaN(s2)) {
                alert("è«‹å¡«å¯«å…©å€‹æ•¸å­—å–”ï¼");
                return;
            }

            if (s1 === qNeed && (s1 + s2) === qSmall) {
                qStep = 2;
                document.getElementById('val-split-1').innerText = s1;
                document.getElementById('val-leftover').innerText = s2;
                
                document.querySelector('.q-display-step2').innerText = `${qLarge} + (${s1} + ${s2})`;
                document.querySelector('.q-display-step3').innerText = `10 + ${s2}`;
                document.getElementById('display-step2-wrapper').classList.remove('hidden');
                document.getElementById('display-step3-wrapper').classList.remove('hidden');

                document.getElementById('ans-split-1').disabled = true;
                document.getElementById('ans-split-2').disabled = true;
                document.getElementById('btn-check-1').classList.add('hidden');
                
                document.getElementById('q-step-1').className = "step-box bg-green-50 border-green-200 opacity-90";
                document.getElementById('q-step-2').className = "step-box active shadow-md";
                document.getElementById('q-step-3').className = "step-box active shadow-md";
                document.getElementById('ans-final').disabled = false;
            } else if ((s1 + s2) !== qSmall) {
                alert(`å–”å–”ï¼${s1} åŠ  ${s2} æ‡‰è©²è¦ç­‰æ–¼ ${qSmall} æ‰å°å”·ã€‚`);
            } else {
                alert(`é›–ç„¶æ‹†åˆ†æ˜¯å°çš„ï¼Œä½†æˆ‘å€‘è¦å…ˆè®“ ${qLarge} è®Šæˆ 10ï¼Œæ‰€ä»¥ç¬¬ä¸€å€‹æ•¸å­—è¦å¡« ${qNeed}ï¼`);
            }
        }

        function checkFinalAnswer() {
            const final = parseInt(document.getElementById('ans-final').value);
            if (final === (qLarge + qSmall)) {
                score += 20;
                document.getElementById('score').innerText = score;
                showCelebration(`${qLarge} + ${qSmall} = ${final}`);
            } else {
                alert(`å†æª¢æŸ¥ä¸€ä¸‹ï¼Œ10 åŠ  ${document.getElementById('val-leftover').innerText} æ˜¯å¤šå°‘å‘¢ï¼Ÿ`);
            }
        }

        function showCelebration(text) {
            document.getElementById('msg-text').innerText = text;
            document.getElementById('msg-box').classList.remove('hidden');
        }

        function closeMsg() {
            document.getElementById('msg-box').classList.add('hidden');
            document.getElementById('btn-check-1').classList.remove('hidden');
            if (document.getElementById('quiz').classList.contains('active')) {
                generateQuiz();
            } else {
                nextLevel();
            }
        }
    </script>
</body>
</html>